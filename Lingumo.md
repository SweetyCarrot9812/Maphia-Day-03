# 📘 Lingumo.md (Product Spec v3)

## 0. 개요
- **앱 이름**: Lingumo  
- **목적**: AI 기반 언어 학습 플랫폼 (초기 영어, 이후 다국어 확장)  
- **대상자**: 한국인 + 비한국인  
- **플랫폼**: Flutter 모바일 앱 + Electron 데스크톱 앱  
- **특징**: 단어·예문 기반 학습 → 실제 미디어 연동 → 스피킹 → 선택형 상황극/라이팅  
- **현재 상태**: 개발 진행 중 (2025-09-04)  

---

## 1. 단어 입력
- **관리자 Sam**이 단어를 등록.  
- 학습자는 등록된 단어/예문을 기반으로 학습.  

---

## 2. 예문 처리
- **우선순위**  
  1) Sam이 등록한 예문 사용.  
  2) 부족하거나 조건 미달 시 → 자동 생성기 사용.  
     - 입력 단어 + 상황태그 + CEFR 길이/문법 가드레일 기반.  
- **포기 버튼**: 예문 단위 suspend 처리(`suspended`).  
  - 단어는 계속 학습됨.  
  - 포기된 예문은 학습 큐에서 제외, 자동 재평가 시스템으로 관리.  

---

## 3. 상황태그
- 앱 첫 실행 시 **AI 질문**:  
  - "어떤 상황에서 언어를 쓰고 싶나요? (카페, 여행, 직장, 병원 등)"  
- 사용자가 대답한 내용이 상황태그로 저장됨.  
- **다중 태그 허용** (예: "카페, 직장, 여행").  
- 이후 예문 생성 시 필수 조건으로 반영.  

---

## 4. 예문 난이도 규칙

### 연령/학년 기준 (PDF 기반)
- 유치원 5세: 2~4 단어  
- 유치원 6세: 3~5 단어  
- 유치원 7세: 4~6 단어  
- 초1: 4~7 단어  
- 초2: 5~8 단어  
- 초3: 6~10 단어  
- 초4: 7~12 단어  
- 초5: 8~13 단어  
- 초6: 9~15 단어  
- 중1: 10~15 단어  
- 중2: 12~18 단어  
- 중3: 13~20 단어  
- 고1: 15~22 단어  
- 고2: 17~25 단어  
- 고3: 20~30 단어  

### 성인 CEFR 기준 (PDF 기반)
- A1: 6~10 단어  
- A2: 8~12 단어  
- B1: 10~15 단어  
- B2: 12~18 단어  
- C1: 15~25 단어  
- C2: 20~30 단어  

### 운용 규칙
- 각 레벨 하한/상한 엄수.  
- 잘 외우면 상한 쪽 예문 제공.  
- 못 외우면 하한 쪽 예문 제공.  

---

## 5. 학습 플로우
1. **예문 제시**  
   - Sam 예문 우선 → 부족 시 자동 생성기.  
2. **미디어 연동**  
   - YouTube / Netflix / 뉴스 / 드라마 / 팟캐스트 클립 자동 매칭.  
   - 실패 시 → TTS 낭독 대체.  
   - 🎬 즐겨찾기/재생목록 기능 지원.  
3. **스피킹 훈련(필수)**  
   - 학습자가 섀도잉 → Azure AI 발음 평가(0~100).  
   - 확장 평가: 발음 + 억양 + 유창성 + 강세.  
   - 실시간 피드백(예: "r 발음이 약간 흐려요").  
4. **추가 학습 옵션 (선택)**  
   - 상황극(Role-play): AI와 대화형 시뮬레이션.  
   - 라이팅(Writing): 예문 변형/확장 글쓰기.  
5. **포기 버튼**  
   - 특정 예문을 suspend 상태로 제외.  

---

## 6. 보조언어 Unlock
- 조건: 주언어 학습이 **CEFR B1 이상** 도달해야 Unlock.  
- 주언어 변경 가능.  
- B1 미만이라도 하루 5장 **데모 모드** 제공.  
- 🌍 교차 언어 학습 확장:  
  - 예) 영어 B2 도달 → 스페인어 학습 시작 시 영어↔스페인어 비교 예문 제공.  
- 🔓 Unlock 보상 애니메이션 제공.  

---

## 7. SRS (Spaced Repetition System)
- **버튼 구조**: Again / Good (2개).  
- **간격 규칙**  
  - Again → `max(10분, 이전 간격 ÷ 3)`  
  - Good →  
    - new → learning: 10분  
    - learning → review: 1일  
    - review 단계: 이전 간격 × 배수  
      - B1 = 2.2  
      - B2 = 2.0  
      - C1+ = 1.8  
- **보정 루프 없음**: 순수 SRS 알고리즘 기반.  

---

## 8. Suspended & Leech
- **포기 버튼**: 예문 단위 suspend 처리.  
- **Leech 카드**:  
  - 연속 Again ≥3 또는 7일 Again ≥4 → suspend 처리.  
- **자동 재평가**  
  - 주 1회 전체 사용자 일괄 복귀 시도.  
  - 🤖 스마트 복귀(AI 선별): "익숙해졌을 것 같은 예문"만 복귀.  
  - 👤 사용자 선택 복귀 옵션 추가.  

---

## 9. 발음 평가
- **TTS**  
  - 단어: Google TTS  
  - 문장: ElevenLabs API (프리셋은 Sam 설정)  
- **발음 채점**: Azure Speech API + 보조 AI, 0~100 점수.  
- **평가 세분화**: 발음·억양·유창성·강세.  
- **실시간 피드백** 제공.  
- **반응시간 측정 없음**  

---

## 10. 개인화 & 적응형 학습
- 📊 개인별 난이도 곡선 추적 → 맞춤 복습 카드 제공.  
- 🎯 목표 기반 추천: "3개월 안에 여행영어 B1 도달" 등 → 맞춤 커리큘럼 제안.  

---

## 11. 게임화 요소
- 🏆 챌린지 모드: "오늘 10문장 섀도잉 성공" → 배지/포인트 지급.  
- 📈 리더보드: 친구 초대 후 순위 경쟁, 주간/월간 챌린지 제공.  
- 🎉 작은 보상: 배지·애니메이션으로 학습 지속률 강화.  

---

# ✅ 최종 결론 (v1)
- 예문은 Sam 등록 → 부족 시 자동 생성기로 보충.  
- 상황태그는 AI 질문→사용자 답변으로 결정, 다중 태그 허용.  
- 난이도는 PDF 기준 CEFR/연령 가드레일 엄수, 상·하한 조절만.  
- 학습 플로우 = 예문→미디어→스피킹(필수) + 상황극/라이팅(선택).  
- 포기 버튼은 예문 전용(suspend).  
- 보조언어 Unlock = B1 이상.  
- SRS = 2버튼, 단순 간격 반복 관리.  
- Suspended 카드는 주 1회 전체 사용자 일괄 재평가.  
- 발음 평가 유지, 반응시간 없음.  

# ✅ 최종 결론 (v3)
- **개인화 학습, 다차원 발음 평가(Azure API), 미디어 확장, 스마트 Suspended 복귀, 게임화, 교차언어 학습** 반영 완료  
- **비용 전략**: 사용료 인상 고려 + Azure API로 확장성 확보  
- **UX 개선**: 성취감과 장기 지속 학습을 동시에 잡는 구조  

---

## 🚀 개발 현황 (2025-09-04 업데이트)

### 📱 Flutter 모바일 앱 (lingumo_app)
- **현재 상태**: 활발히 개발 중
- **주요 의존성**:
  - UI: Flutter Material Design, Lottie animations, Staggered animations
  - 상태관리: Provider pattern
  - 데이터: SQLite (sqflite), Hive (key-value storage)
  - 오디오: flutter_tts, audioplayers
  - HTTP: dio, http
  - 차트: fl_chart (진도 추적용)
- **배치 기록**: batch_005까지 진행 (2025-08-24)
- **위치**: `C:\Users\tkand\Desktop\development\Hanoa\Lingumo app\lingumo_app`

### 🖥️ Desktop 앱 (Electron)
- **현재 상태**: 기본 구조 완성
- **기술 스택**: Electron + HTML/CSS/JS + MongoDB
- **주요 기능**: 
  - Hot reload 개발 환경
  - MongoDB 통합
  - Cross-platform 빌드 (Windows NSIS)
- **위치**: `C:\Users\tkand\Desktop\development\Hanoa\Lingumo Desktop`

### 🔧 기술 아키텍처
- **데이터베이스**: 
  - 모바일: SQLite (오프라인) + Hive (설정)
  - 데스크톱: MongoDB (클라우드 연동)
- **AI 통합**: 계획된 TTS/STT 서비스 연동 준비
- **동기화**: 멀티플랫폼 데이터 동기화 구조 설계

### 📋 개발 우선순위
1. **Core SRS System**: 기본 간격 반복 학습 알고리즘
2. **예문 관리**: Sam 관리자 인터페이스 + 자동 생성 시스템
3. **발음 평가**: Azure Speech API 통합
4. **미디어 연동**: YouTube/Netflix 클립 매칭 시스템
5. **상황태그**: AI 기반 개인화 태그 시스템

### 🎯 다음 단계
- [ ] SRS 알고리즘 구현 완료
- [ ] 기본 UI/UX 프로토타입
- [ ] MongoDB 스키마 최적화
- [ ] 크로스 플랫폼 데이터 동기화
- [ ] 베타 테스트 준비

---

## 🛠️ 최근 개발 이슈 및 해결 (2025-09-04)

### ❌ 발견된 문제
**카드만들기 + 버튼 기능 작동 불가**
- 사용자 증상: Desktop 앱에서 카드 추가 버튼 클릭해도 반응 없음
- 위치: `Lingumo Desktop/src/index.html` - `id="add-card"` 버튼

### 🔍 디버깅 과정
1. **HTML 구조 확인**: ✅ `id="add-card"` 버튼 정상 존재 
2. **JavaScript 이벤트**: ✅ `addEventListener('click', addCard)` 정상 등록
3. **함수 구현**: ✅ `addCard()` 함수 정상 구현

### 🛠️ 적용된 해결책
**디버깅 로그 및 오류 처리 강화** (commit: 2c9f5c5)
```javascript
// src/app.js - addCard() 함수 개선
- 상세한 콘솔 로그 추가 (입력값, 생성 카드, 배열 상태 등)
- try-catch 블록으로 오류 추적 강화  
- 카드 추가 성공시 "✅ 카드가 추가되었습니다!" 피드백 표시
- 오류 발생시 사용자에게 구체적 알림 메시지
```

### 🎯 현재 상태 
- **개발자 모드**: `npm run dev` 또는 `electron . --dev`로 실행 시 DevTools 자동 열림
- **디버깅 준비**: 콘솔에서 상세한 실행 로그 확인 가능
- **다음 단계**: 실제 + 버튼 클릭 테스트하여 정확한 오류 원인 파악

### 💡 추정 원인
1. **MongoDB 연결 실패**: 로컬 MongoDB 미실행 또는 연결 문제
2. **Electron IPC 통신 오류**: main.js ↔ renderer 프로세스 간 통신 실패  
3. **환경 설정 문제**: .env 파일 또는 경로 관련 설정 오류
4. **캐시 문제**: Electron 앱 캐시로 인한 코드 미반영  